import sys
import pickle
import numpy as np

# take imput fron c#
# string = "".join(sys.argv[1:]
string = '332, 224, 8450, 14, 14, 304640, 491008, 0, 177964, 4096, 311296, 268435456, 4096, 512, 5, 1, 0, 0, 5, 1, 806912, 1024, 452750, 2, 320, 1048576, 4096, 1048576, 4096, 0, 16'

# convert string to numpy array
arr = np.array(list(string.split(',')))

# load the ML model
filename = 'classifier_model_1.sav'
loaded_model = pickle.load(open(filename, 'rb'))

# make prediction
result = loaded_model.predict([arr])
if result[0] == 1:
    print('legit')
else:
    print('malware')