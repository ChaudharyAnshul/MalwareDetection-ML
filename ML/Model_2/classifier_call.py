import sys
import pickle
import numpy as np

# take imput fron c#
# string = "".join(sys.argv[1:]
string = '332, 224, 258, 10, 385024, 0, 576571, 33088'

# convert string to numpy array
arr = np.array(list(string.split(',')))

# load the ML model
filename = 'classifier_model_2.sav'
loaded_model = pickle.load(open(filename, 'rb'))

# make prediction
result = loaded_model.predict([arr])
if result[0] == 1:
    print('legit')
else:
    print('malware')
